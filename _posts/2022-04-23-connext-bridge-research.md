---
layout: post
title:  "Connext Bridge Research"
author: devfans
categories: [ Connext, BlockChain, Bridge, Research ]
image: /static.livefeed.cn/static/blog/connext.png
tags: [ featured ]
---

Recently, I did some researches on some existing popular cross chain bridges, here to dump them on the blog with three pages, for Celer Bridge, Connext, MultiChain respectively.

Here's the original doc:

<div class="c8"><p class="c19"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 8.00px;"><img alt="" src="https://static.livefeed.cn/static/blog/connext-image1.png" style="width: 624.00px; height: 8.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title="horizontal line"></span></p><p class="c14 title" id="h.2gazcsgmxkub"><span class="c12 c2 c21">Connext Research</span></p><p class="c3 subtitle" id="h.2nuf54q86v7q"><span class="c5 c12">April.2022 / stefan liu</span></p><p class="c19"><span class="c12 c2 c16">&#9472;</span></p><h1 class="c7" id="h.pmazbh81wixz"><span class="c6 c2">About</span></h1><p class="c3"><span class="c0">Connext is the interoperability protocol of L2 Ethereum.</span></p><p class="c3"><span>&#8203;&#8203;In general, Connext adopts the same core security model as other locking systems such as HTLCs. Unlike other systems, Connext is less vulnerable to free options as all interactions across chains are with </span><span class="c2">1:1 assets </span><span class="c0">(e.g. ETH on Optimism to ETH on Arbitrum).</span></p><p class="c3"><span>Note that the current version of Connext </span><span class="c2">cannot be used pass arbitrary event data between chains</span><span class="c0">&nbsp;(i.e. prove to chain B that something occurred on chain A) as this cannot be done in a trust-minimized way in the evm except by incurring the 1-week exit window of existing rollup bridges.</span></p><p class="c17"><span class="c10"></span></p><p class="c19"><span class="c1 c15"><a class="c13" href="https://www.google.com/url?q=https://connextscan.io/&amp;sa=D&amp;source=editors&amp;ust=1650625223390349&amp;usg=AOvVaw1MWB8qUCMr2I9bR8DuJUzl">https://connextscan.io/</a></span></p><h1 class="c7" id="h.3at9u9s4e0vp"><span class="c6 c2">NXTP</span></h1><p class="c3"><span class="c2">Noncustodial Xchain Transfer Protocol.</span></p><p class="c3"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 230.67px;"><img alt="" src="https://static.livefeed.cn/static/blog/connext-image2.png" style="width: 624.00px; height: 230.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><ol class="c9 lst-kix_8ptmsowchg22-0 start" start="1"><li class="c3 c4 li-bullet-0"><span class="c2">Route Auction</span><span class="c0">: User broadcasts to our network signalling their desired route. Routers respond with sealed bids containing commitments to fulfilling the transaction within a certain time and price range.</span></li><li class="c3 c4 li-bullet-0"><span class="c2">Prepare</span><span class="c0">: Once the auction is completed, the transaction can be prepared. The user submits a transaction to TransactionManager contract on sender-side chain containing router&#39;s signed bid. This transaction locks up the users funds on the sending chain. Upon detecting an event containing their signed bid from the chain, router submits the same transaction to TransactionManager on the receiver-side chain, and locks up a corresponding amount of liquidity. The amount locked on the receiving chain is sending amount - auction fee so the router is incentivized to complete the transaction.</span></li><li class="c3 c4 li-bullet-0"><span class="c2">Fulfill</span><span class="c0">: Upon detecting the TransactionPrepared event on the receiver-side chain, the user signs a message and sends it to a relayer, who will earn a fee for submission. The relayer (which may be the router) then submits the message to the TransactionManager to complete their transaction on receiver-side chain and claim the funds locked by the router. A relayer is used here to allow users to submit transactions with arbitrary calldata on the receiving chain without needing gas to do so. The router then submits the same signed message and completes transaction on sender-side, unlocking the original amount.</span></li></ol><h1 class="c7" id="h.izh0w05mz75r"><span class="c6 c2">Bridge Fees</span></h1><ul class="c9 lst-kix_ajcih27tlk1j-0 start"><li class="c3 c4 li-bullet-0"><span class="c2">Router fee</span><span class="c0">&nbsp;currently 0.05% of transaction size </span></li><li class="c3 c4 li-bullet-0"><span class="c2">ReceiverChain GasFee</span><span class="c0">&nbsp;If a user sends it themselves, then the costs are in the native asset of the receiving chain (the gas fee associated with any onchain transaction). If the transaction is sent via relayers, then the cost comes out of the asset you receive (i.e. the USDC relayer fee is deducted from the amount the router put up for you on the destination chain)</span></li></ul><h1 class="c7" id="h.yb84yajcu17v"><span class="c6 c2">Contracts</span></h1><p class="c3"><span class="c2 c11">TransactionManager</span></p><p class="c3"><span class="c1"><a class="c13" href="https://www.google.com/url?q=https://etherscan.io/address/0x31eFc4AeAA7c39e54A33FDc3C46ee2Bd70ae0A09%23code&amp;sa=D&amp;source=editors&amp;ust=1650625223393527&amp;usg=AOvVaw3-t6WgyhaujvP9h9WTj8jy">https://etherscan.io/address/0x31eFc4AeAA7c39e54A33FDc3C46ee2Bd70ae0A09#code</a></span></p><p class="c3"><span class="c1"><a class="c13" href="https://www.google.com/url?q=https://github.com/connext/nxtp/tree/main/packages/contracts&amp;sa=D&amp;source=editors&amp;ust=1650625223394070&amp;usg=AOvVaw0dtA4dIwe4gMnU3fHJ1v_g">https://github.com/connext/nxtp/tree/main/packages/contracts</a></span></p><p class="c3"><span class="c0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Prepare</span></p><p class="c3"><span class="c0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Fulfill</span></p><p class="c3"><span class="c0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AddLiquidity</span></p><p class="c3"><span class="c0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RemoveLiquidity</span></p><p class="c3 c18"><span class="c0"></span></p><h1 class="c7" id="h.joi9uxipmmvr"><span class="c6 c2">Routers</span></h1><p class="c3"><span class="c1"><a class="c13" href="https://www.google.com/url?q=https://github.com/connext/nxtp/tree/4153114acca33b2e914d17f6cc974e607152f28d/packages/router&amp;sa=D&amp;source=editors&amp;ust=1650625223395422&amp;usg=AOvVaw3htlZC_ZRll0XeZjy3PEqu">https://github.com/connext/nxtp/tree/4153114acca33b2e914d17f6cc974e607152f28d/packages/router</a></span></p><p class="c3 c18"><span class="c0"></span></p><ul class="c9 lst-kix_iidgcfh27coh-0 start"><li class="c3 c4 li-bullet-0"><span class="c0">Listen for user swap requests.</span></li><li class="c3 c4 li-bullet-0"><span class="c0">Submit bids to fulfill user swap requests.</span></li><li class="c3 c4 li-bullet-0"><span class="c0">Monitor TransactionManager contract events across all chains for TransactionPrepared events where router matches the configured router&#39;s signer address, and sendingChainId matches the chain of the event.</span></li><li class="c3 c4 li-bullet-0"><span class="c0">Call prepare on the receiving chain with amount = amount - calculatedFees where calculatedFees are a combination of the AMM-based swap rate, flat 0.05% fee, and any gas fees that will be reimbursed by the user.</span></li><li class="c3 c4 li-bullet-0"><span class="c0">Monitor TransactionManager contract events across all chains for TransactionFulfilled events where router matches the configured router&#39;s signer address and receivingChainId matches the chain of the event.</span></li><li class="c3 c4 li-bullet-0"><span class="c0">Call fulfill on the sending chain with the signature emitted from the TransactionFulfilled event.</span></li></ul><p class="c3"><span class="c2">Auction</span><span>: </span><span class="c1"><a class="c13" href="https://www.google.com/url?q=https://github.com/connext/nxtp/blob/4153114acca33b2e914d17f6cc974e607152f28d/packages/router/src/handler.ts%23L176&amp;sa=D&amp;source=editors&amp;ust=1650625223397113&amp;usg=AOvVaw3djPIB9VDUe9d-NrbrotmO">https://github.com/connext/nxtp/blob/4153114acca33b2e914d17f6cc974e607152f28d/packages/router/src/handler.ts#L176</a></span></p><h1 class="c7" id="h.6zsavxw7qpwy"><span class="c2 c6">Risks</span></h1><p class="c3"><span class="c2">DoS and Griefing</span><span class="c0">&nbsp;In the short term, there is a whitelist for routers in the core contracts which the Connext team has the ability to update. The Connext team expects to work closely with an initial set of pilot routers that are trustworthy and reputationally disincentivized to attempt to grief users.</span></p><p class="c3 c18"><span class="c0"></span></p><br><br><br></div>
<div><p class="c20"><span class="c5">&nbsp; </span></p><p class="c22"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 8.00px;"><img alt="" src="https://static.livefeed.cn/static/blog/connext-image1.png" style="width: 624.00px; height: 8.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title="horizontal line"></span><span class="c0">&nbsp;</span></p></div>
